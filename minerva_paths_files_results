MGE=IN_SST|IN_PVALB|IN_PVALB_CHC
CGE=IN_VIP|IN_ADARB2|IN_LAMP5_RELN|IN_LAMP5_LHX6

“EN_L5_6_NP|EN_L6_CT|EN_L6B”=“deep_non_IT”
“EN_L2_3_IT|EN_L3_5_IT_1|EN_L3_5_IT_2|EN_L3_5_IT_3”=“upper_IT”
“EN_L6_IT_2|EN_L6_IT_1”=“deep_IT”

### Cell types order according to mean pseudotime (from young to old)
EN: EN_L6_IT_2, EN_L6B, EN_L6_IT_1, EN_L6_CT, EN_L5_6_NP, EN_L3_5_IT_3, EN_L3_5_IT_1, EN_L2_3_IT, EN_L3_5_IT_2
IN: IN_ADARB2_RAB37, IN_LAMP5_LHX6, IN_ADARB2_SYT10, IN_LAMP5_RELN, IN_PVALB_CHC, IN_ADARB2_SV2C, IN_ADARB2_COL12A1, IN_VIP, IN_SST IN_PVALB
AST: Astro_ADAMTSL3, Astro_PLSCR1

### 284 donors h5ad file
/sc/arion/projects/CommonMind/aging/input_files/freeze3.0/

>> umap (6k hvf): ~/aging_umap.h5ad (or ~/aging_umap_age.h5ad with added age and age_groups)
>> stdz. libs 1000 file: ~/Aging_freeze3.0_full_std1_000.h5ad
>> scDRS results : ~/trait_scores80ctr

### 291 donors h5ad file
/sc/arion/projects/psychAD/NPS-AD/freeze2_rc/h5ad_final/AGING_2024-02-01_22_23.h5ad



####### 15th February freeze email from gabe #######

# final_samples after removing outliers (284)
/sc/arion/projects/CommonMind/aging/resources/AGING_2024-02-01_22_23_processAssays_SubID_subclass.txt

# Outlier analysis drops 7 samples:

H1143, H826, H1708, H1405, H1061, H1866, M81548

# analysis from gabe link
https://www.synapse.org/#!Synapse:syn22343687/wiki/620914
https://hoffmg01.hpc.mssm.edu/nps_ad/analysis/freeze2/preprocess/preprocess_AGING.html
user: roussoslab
pw: d3g31gv03

## link from gabe for pipeline

https://www.synapse.org/#!Synapse:syn22343687/wiki/620914  
topTable_combined.tsv.gz

/sc/arion/projects/CommonMind/aging/resources/topTable_combined.tsv.gz
zcat /sc/arion/projects/CommonMind/aging/resources/topTable_combined.tsv.gz | grep AGING > /sc/arion/projects/CommonMind/aging/resources/topTable_combined_AGING.tsv


# markers list for psychAD project from Tereza and donghoon (Feb 6 2024)
/sc/arion/projects/psychAD/NPS-AD/freeze2_proc/231109_PsychAD_capstone_F2/240131_PsychAD_freeze3_markers_all_final.csv

#/sc/arion/projects/CommonMind/aging/resources/Xenium_gene_list_05_04.csv

# list of cotrasts from Jaro: https://www.synapse.org/#!Synapse:syn51114763 (google doc link or below)
/sc/arion/projects/psychAD/NPS-AD/freeze1_rc/metadata/contrasts_for_dreamlet.Rdata


# age groups based on https://www.nature.com/articles/nature10523
neonatal = 0-1years
childhood = 2-11years
adolescence = 12-19years
young adulthood = 20-39years
middle adulthood = 40-59years
late adulthood = > 60years

# usage
pb=readRDS("/sc/arion/projects/psychAD/NPS-AD/freeze2_rc/pseudobulk/AGING_2024-02-01_22_23_PB_SubID_subclass.RDS")
form = as.formula("~ Source + Sex + scale(PMI) + log(n_genes) + percent_mito + mito_genes + mito_ribo + ribo_genes")
colData(pb)$SubID=rownames(colData(pb))

#### keep final samples
samples_to_keep=read.table("/sc/arion/projects/CommonMind/aging/resources/AGING_2024-02-01_22_23_processAssays_SubID_subclass.txt")
pb_subset=pb[,colData(pb)$SubID %in% samples_to_keep$V1]

colData(pb_subset)$groups="NA"
colData(pb_subset)$groups[colData(pb_subset)$Age<1]="Neonatal"
colData(pb_subset)$groups[colData(pb_subset)$Age>=1 & colData(pb_subset)$Age<12]="Childhood"
colData(pb_subset)$groups[colData(pb_subset)$Age>=12 & colData(pb_subset)$Age<20]="Adolescence"
colData(pb_subset)$groups[colData(pb_subset)$Age>=20 & colData(pb_subset)$Age<40]="Young_Adulthood"
colData(pb_subset)$groups[colData(pb_subset)$Age>=40 & colData(pb_subset)$Age<60]="Middle_Adulthood"
colData(pb_subset)$groups[colData(pb_subset)$Age>=60]="Late_Adulthood"

     Adolescence        Childhood   Late_Adulthood Middle_Adulthood
              33               11               82               95
        Neonatal  Young_Adulthood
               9               54

## grouping by source

                    H  M
  Neonatal          9  0
  Adolescence      33  0
  Childhood        11  0
  Young_Adulthood  44 10
  Middle_Adulthood 60 35
  Late_Adulthood   15 67



# current color pallete for age groups
#previous color scheme  ###agec=  ['#FFEBCC','#FFDAB9','#FFC58C','#FFA54F','#FF8C00', '#D2691E']
custom_order = ['Neonatal','Childhood','Adolescence','Young Adulthood','Middle Adulthood','Late Adulthood']
hex_codes = ['#E9D8A6', '#F9CFA1', '#FFCC66', '#EE9B00', '#CA6702', '#8C510A']



# color pallete for analyses
"Greens" # MAGMA by Jaro
"vlag" or "RdBu" # scDRS heatmap association score; (min_value, plus_value)
"YlOrRd" # yellowish-red spectrum for 0-1 values?

## EN lineages from Hui
L6_IT_2, L6_IT1, L6_CT, L5_6_NP, L6B, L3_5_IT_3, L3_5_IT_1, L3_5_IT_2, L2_3_IT.

### data frame of 1.196831M cells and their donor IDs from aging cohort
/sc/arion/projects/CommonMind/aging/aging_cells_anno_age.RDATA

RAW file
file="/sc/arion/projects/psychAD/NPS-AD/freeze2_rc/h5ad_final/AGING_2023-09-12_20_35.h5ad"

## colormap
cmap=read.csv("/sc/arion/projects/CommonMind/aging/resources/230921_PsychAD_color_palette.csv")


# Processed Aging cohort using minimum covariates: ~sex + PMI + log(n_genes) + batchID
/sc/arion/projects/CommonMind/aging/hui/files/combined_pc_normed_hvg_regressed_harmony_2023-09-12_20_35.h5ad (syn53065349)
# Processed HBCC cohort using minimum covariates: ~sex + PMI + log(n_genes) + batchID
/sc/arion/projects/CommonMind/aging/hui/files/hbcc_pc_normed_hvg_regressed_harmony_2023-09-12_20_35.h5ad (syn52928681)


Lister file
/sc/arion/projects/CommonMind/aging/hui/files/lister_processed.h5ad

Aging+Lister

/sc/arion/projects/CommonMind/aging/hui/files/aging_lister_combined_ds1000_rmno_beforeUMAT_full_adata.h5ad (syn53064494)

# easy to read in R

/sc/arion/projects/psychAD/NPS-AD/freeze2_proc/230816_PsychAD_capstone_F1/aging_lister_combined_ds1000_rmno_beforeUMAT_full_adata_fixed.h5ad

### this is our pseudobulk files to be used for any downstream analysis
### no duplicates matrices
### class
/sc/arion/projects/psychAD/NPS-AD/freeze2_rc/pseudobulk/AGING_2023-06-09_01_45_PB_SubID_bulk.RDS
### subtype
/sc/arion/projects/psychAD/NPS-AD/freeze2_rc/pseudobulk/AGING_2023-06-09_01_45_PB_SubID_subtype.RDS
### sublcass
/sc/arion/projects/psychAD/NPS-AD/freeze2_rc/pseudobulk/AGING_2023-06-09_01_45_PB_SubID_subclass.RDS

### with duplicates matrices
### class
/sc/arion/projects/psychAD/NPS-AD/freeze2_rc/pseudobulk/AGING_2023-06-09_01_45_PB_Channel_bulk.RDS
### subtype
/sc/arion/projects/psychAD/NPS-AD/freeze2_rc/pseudobulk/AGING_2023-06-09_01_45_PB_Channel_subtype.RDS
### sublcass
/sc/arion/projects/psychAD/NPS-AD/freeze2_rc/pseudobulk/AGING_2023-06-09_01_45_PB_Channel_subclass.RDS

### h5ad file for different lineages including UMAT / UMAP from Hui
/sc/arion/projects/CommonMind/aging/hui/files/aging_lister_combined_ds1000_rmno_EN_withlabels_sparse_123456_clustering.h5ad
/sc/arion/projects/CommonMind/aging/hui/files/aging_lister_combined_ds1000_rmno_IN_withlabels_sparse_123456_clustering.h5ad
/sc/arion/projects/CommonMind/aging/hui/files/aging_lister_combined_ds1000_rmno_AST_withlabels_sparse_123456_clustering.h5ad
/sc/arion/projects/CommonMind/aging/hui/files/aging_lister_combined_ds1000_rmno_Micro_withlabels_sparse_123456_clustering.h5ad
/sc/arion/projects/CommonMind/aging/hui/files/aging_lister_combined_ds1000_rmno_OPC_Oligo_withlabels_sparse_123456_clustering.h5ad

### pseudotime for different lineages from Hui
/sc/arion/projects/CommonMind/aging/hui/files/aging_lister_combined_ds1000_rmno_EN_withlabels_sparse_123456_X_umat_kriegstein_afterCombination_cds_v3.RDS
/sc/arion/projects/CommonMind/aging/hui/files/aging_lister_combined_ds1000_rmno_IN_withlabels_sparse_123456_X_umat_kriegstein_afterCombination_cds_v3.RDS
/sc/arion/projects/CommonMind/aging/hui/files/aging_lister_combined_ds1000_rmno_AST_withlabels_sparse_123456_X_umat_kriegstein_afterCombination_cds_v3.RDS
/sc/arion/projects/CommonMind/aging/hui/files/aging_lister_combined_ds1000_rmno_Micro_withlabels_sparse_123456_X_umat_kriegstein_afterCombination_cds_v3.RDS
/sc/arion/projects/CommonMind/aging/hui/files/aging_lister_combined_ds1000_rmno_OPC_Oligo_withlabels_sparse_123456_top200_dreamlet_updown_half_25_X_umat_kriegstein_afterCombination_cds_v3.RDS

### DEGs for each lineage using moran test from Hui
/sc/arion/projects/CommonMind/aging/hui/files/DEGs_moran_test/modified_10000/*_pt_DGE*txt

### branch-specific DEGs from Hui
/sc/arion/projects/CommonMind/aging/hui/files/DEGs_moran_test/modified_10000/branch_spec/*.txt

### sex-specific DEGs for different lineages from Hui (only for AST now)
/sc/arion/projects/CommonMind/aging/hui/files/DEGs_moran_test/modified_10000/*_spec.txt

### Extract cell_id and pseudotime for different lineages from Hui
/sc/arion/projects/CommonMind/aging/hui/files/pseudotime/EN_X_umat_v3_pseudotime.csv
/sc/arion/projects/CommonMind/aging/hui/files/pseudotime/IN_X_umat_v3_pseudotime.csv
/sc/arion/projects/CommonMind/aging/hui/files/pseudotime/AST_X_umat_v3_pseudotime.csv
/sc/arion/projects/CommonMind/aging/hui/files/pseudotime/Micro_X_umat_v3_pseudotime.csv
/sc/arion/projects/CommonMind/aging/hui/files/pseudotime/OPC_Oligo_X_umat_diffparas_v3_pseudotime.csv

### 500 meta-cells for different lineages from Hui
### extended cds object in R (can be accessed throught cds@expression$lineage_name for expression, cds@pseudotime$lineage_name for pseudotime)
/sc/arion/projects/CommonMind/aging/hui/files/aging_lister_combined_ds1000_rmno_AST_withlabels_sparse_123456_X_umat_kriegstein_afterCombination_cds_compressed_v3.RDS
/sc/arion/projects/CommonMind/aging/hui/files/aging_lister_combined_ds1000_rmno_EN_withlabels_sparse_123456_X_umat_kriegstein_afterCombination_cds_compressed_v3.RDS
/sc/arion/projects/CommonMind/aging/hui/files/aging_lister_combined_ds1000_rmno_IN_withlabels_sparse_123456_X_umat_kriegstein_afterCombination_cds_compressed_v3.RDS
/sc/arion/projects/CommonMind/aging/hui/files/aging_lister_combined_ds1000_rmno_Micro_withlabels_sparse_123456_X_umat_kriegstein_afterCombination_cds_compressed_v3.RDS
/sc/arion/projects/CommonMind/aging/hui/files/aging_lister_combined_ds1000_rmno_OPC_Oligo_withlabels_sparse_123456_X_umat_kriegstein_afterCombination_cds_compressed_v3.RDS
### merged h5ad file
/sc/arion/projects/CommonMind/aging/hui/files/500_meta_cell_lineage_h5ad/500_meta_cell_lineage_merged.h5ad



###PACScores
/sc/arion/projects/psychAD/aging/PACscores/hbcc_aging_obs.csv

### raw and residuals crumblr cell composition using bestModel="~ (1 | BatchID) + (1|Source) + scale_PMI + log_n_genes"
:/sc/arion/projects/CommonMind/aging/resources/cell_composition_subclass.RDATA

scDRS_scores=fread("/sc/arion/projects/CommonMind/aging/analysis/scdrs/trait_scores_all_RNA_Aging100perc.csv")



### Circadian genes with peak time from Madeline
/sc/arion/projects/CommonMind/aging/hui/files/Sleep_pattern/2023-10-26_Circ_Genes_w_Peak_Time.xlsx



#### lifespan trajectories DEGs using polynomial model poly(log2(Age + 1), df = 2)
load("/sc/arion/projects/psychAD/aging/kiran/analysis/lifespan/subclass/best_model/lifespan_coefs_dream_results_best_model.RDATA")
 # use lifespan_dream_results_df
 # coef_1 is beta for coeffcient 1, coef_2 is beta for coeffcient 2
 # adj.P.Val is joint adjusted P value for both coefs. 
# adj.P.Val_1 and adj.P.Val_2 are respective adjusted P values for coef 1 and coef 2 individually


### clusters and genes from Hui

/sc/arion/projects/CommonMind/aging/hui/files/freeze3/DEGs_moran_test/modified_10000/qvalue0.05_moran200/*N_ordered_lineage_mean_peak_ks_9_cluster_*.csv
